import{u as C,r as d,s as i,a as v,S as x,c as h,j as y,I as F,$ as R,b as S,d as b}from"./index-_TQD0Y1q.js";import{d as E}from"./index-fFXo6fwo.js";const I=({limit:s,perPage:a,query:r,skip:l,after:p,clear:n})=>{const{error:t,loading:o}=C(x,{variables:{first:s,query:r,after:p},skip:l,onCompleted:c=>{var u;const{search:e}=c;e&&e.edges&&(v({data:{searchRepos:{count:e==null?void 0:e.repositoryCount,repos:e==null?void 0:e.edges,lastCursor:e.repositoryCount>s&&String((u=e==null?void 0:e.edges[s-1])==null?void 0:u.cursor)||""}},clear:n}),n&&i({page:1,pageByNewFetch:Math.round(a/2)}))}});d.useEffect(()=>{i({pageByNewFetch:Math.round(a/2)})},[a,r]),d.useEffect(()=>{i({loading:o,error:t==null?void 0:t.message})},[t==null?void 0:t.message,o])},$=()=>{var f;const s=d.useRef(null),{page:a,limit:r,clearFetch:l,perPage:p,isUserInfo:n,search:t}=h(R),o=h(S);I({limit:Number(r)||100,after:o,perPage:p,query:t,skip:n,clear:l});const c=()=>{var g;s.current&&(i({search:(g=s.current)==null?void 0:g.value,clearFetch:!0,isUserInfo:!s.current.value,page:s.current.value?a:1}),b(""))},e=E(()=>{c()},500),u=()=>{e()},m=()=>{s.current&&(s.current.value="",c())};return y.jsx(F,{ref:s,id:"search",type:"text",placeholder:"Search repositories",onChange:u,isFilled:!!((f=s.current)!=null&&f.value),clear:m})};export{$ as Search,$ as default};
